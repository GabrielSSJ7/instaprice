{"version":3,"file":"static/webpack/static\\development\\pages\\Profile.js.aa308c29bed755939b8a.hot-update.js","sources":["webpack:///./pages/Profile.js"],"sourcesContent":["import React from \"react\";\r\nimport Template from \"../components/Template\";\r\nimport TopMenu from \"../components/TopMenu\";\r\nimport BottomMenu from \"../components/BottomMenu\";\r\nimport { connect } from \"react-redux\";\r\nimport { bindActionCreators } from \"redux\";\r\nimport \"isomorphic-unfetch\";\r\nimport axios from \"axios\";\r\nimport DatePicker from \"react-datepicker\";\r\nimport Modal from \"react-responsive-modal\";\r\nvar dateFormat = require(\"dateformat\");\r\n\r\nimport { library } from \"@fortawesome/fontawesome-svg-core\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faEdit, faUser } from \"@fortawesome/free-solid-svg-icons\";\r\nlibrary.add(faEdit);\r\nlibrary.add(faUser);\r\n\r\nimport Head from \"next/head\";\r\nimport cssStype from \"react-datepicker/dist/react-datepicker.css\";\r\nimport { URL as URL_ } from \"../config/types\";\r\nimport { editUser, validateToken, getAddress } from \"../components/Util\";\r\nimport UserProfile from \"../components/ProfileTabs/UserProfile\";\r\nimport AddressProfile from \"../components/ProfileTabs/AddressProfile\";\r\nimport CardsProfile from \"../components/ProfileTabs/CardsProfile\";\r\n\r\nclass profile extends React.Component {\r\n  static async getInitialProps({ store, isServer, req }) {\r\n    const cookie = req ? req.headers.cookie : \"\";\r\n    if (cookie) {\r\n      const index = cookie.indexOf(\"bearer\");\r\n      let AuthToken = cookie.substr(index);\r\n      AuthToken = AuthToken.split(\"%20\").join(\" \");\r\n      const i = AuthToken.indexOf(\"; \")\r\n      AuthToken = AuthToken.substring(0, i)\r\n      const token = AuthToken.split(\"bearer \").join(\"\");\r\n      const options = {\r\n        headers: { Authorization: AuthToken }\r\n      };\r\n      console.log(\"header Auth\",AuthToken)\r\n      const user = await fetch(`${URL_}user/${token}`, options);\r\n      const data = await user.json();\r\n      console.log(\"user data\", user)\r\n      //const data = []\r\n      return { user: data };\r\n    }\r\n    return {};\r\n  }\r\n\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      open: false,\r\n      openEditUser: false,\r\n      file: null,\r\n      image: null,\r\n      startDate: new Date(\"2000-05-22\"),\r\n      foto: \"\",\r\n      nome: null,\r\n      cpf: \"não informado\",\r\n      sexo: \"não informado\",\r\n      msg: \"\",\r\n      progress: \"\",\r\n      email: \"\",\r\n      data_de_nascimento: null,\r\n      event: null,\r\n      tab: null,\r\n      enderecos: []\r\n    };\r\n\r\n    this.handleChange.bind(this);\r\n  }\r\n\r\n  componentDidMount() {\r\n    getAddress(this);\r\n    if (!this.props.user) {\r\n      this.getAllUserData();\r\n    } else {\r\n      this.setState({\r\n        nome: this.props.user.nome,\r\n        cpf: this.props.user.cpf,\r\n        sexo: this.props.user.sexo,\r\n        data_de_nascimento: this.props.user\r\n          ? this.props.user.data_de_nascimento\r\n          : null,\r\n        foto: this.props.user.foto,\r\n        email: this.props.user.email\r\n      });\r\n    }\r\n  }\r\n\r\n  getAllUserData() {\r\n    const token = localStorage.getItem(\"authToken\");\r\n    const instance = axios.create({\r\n      headers: { Authorization: `bearer ${token}` }\r\n    });\r\n    instance.get(`${URL_}user/${token}`).then(res => {\r\n      this.setState({\r\n        startDate: res.data.data_de_nascimento,\r\n        data_de_nascimento: res.data.data_de_nascimento\r\n          ? res.data.data_de_nascimento\r\n          : null,\r\n        nome: res.data.nome,\r\n        cpf: res.data.cpf ? res.data.cpf : null,\r\n        sexo: res.data.sexo ? res.data.sexo : null,\r\n        foto: res.data.foto,\r\n        email: res.data.email\r\n      });\r\n    });\r\n  }\r\n\r\n  showPhoto() {\r\n    if (this.props.user || this.state.foto) {\r\n      return (\r\n        <img\r\n          className=\"rounded-circle img-fluid\"\r\n          src={this.state.foto}\r\n          alt={`instaprice ${\r\n            this.props.user ? this.props.user.nome : this.state.nome\r\n          }`}\r\n        />\r\n      );\r\n    } else {\r\n      return (\r\n        <img\r\n          className=\"rounded-circle img-fluid\"\r\n          src=\"https://pbs.twimg.com/profile_images/573692360263004161/gOvizBEP.jpeg\"\r\n          alt={`instaprice ${\r\n            this.props.user ? this.props.user.nome : this.state.nome\r\n          }`}\r\n        />\r\n      );\r\n    }\r\n  }\r\n\r\n  onOpenModal = () => {\r\n    this.setState({ open: true });\r\n  };\r\n\r\n  onCloseModal = () => {\r\n    this.setState({ open: false });\r\n  };\r\n\r\n  onOpenModalEditUser = () => {\r\n    this.setState({ openEditUser: true });\r\n  };\r\n\r\n  onCloseModalEditUser = () => {\r\n    this.setState({ openEditUser: false });\r\n  };\r\n\r\n  handleImage(event) {\r\n    //const { event } = this.state;\r\n    this.onOpenModal();\r\n    this.setState({ image: event.target.files[0] });\r\n    if (event.target.files[0]) {\r\n      this.setState({\r\n        file: URL.createObjectURL(event.target.files[0])\r\n      });\r\n    }\r\n  }\r\n\r\n  _userEdit() {\r\n    const data = {\r\n      nome: this.state.nome,\r\n      sexo: this.state.sexo,\r\n      data_de_nascimento: this.state.data_de_nascimento,\r\n      cpf: this.state.cpf\r\n    };\r\n\r\n    editUser(data, null, this);\r\n  }\r\n\r\n  _userEditFoto() {\r\n    let data = {};\r\n    editUser(data, this.state.image, this);\r\n  }\r\n\r\n  handleChange(date) {\r\n    this.setState({\r\n      data_de_nascimento: date\r\n    });\r\n  }\r\n\r\n  changeTab() {\r\n    switch (this.state.tab) {\r\n      case \"profile\":\r\n        return (\r\n          <UserProfile\r\n            data={this.state}\r\n            showPhoto={() => this.showPhoto()}\r\n            handleImage={this.handleImage.bind(this)}\r\n            onOpenModalEditUser={this.onOpenModalEditUser.bind(this)}\r\n            ctx={this}\r\n          />\r\n        );\r\n\r\n      case \"address\":\r\n        return <AddressProfile data={this.state} />;\r\n      \r\n      case \"cards\":\r\n          return <CardsProfile data={this.state} />\r\n\r\n      default:\r\n        return (\r\n          <UserProfile\r\n            data={this.state}\r\n            showPhoto={() => this.showPhoto()}\r\n            handleImage={this.handleImage.bind(this)}\r\n            onOpenModalEditUser={this.onOpenModalEditUser.bind(this)}\r\n            ctx={this}\r\n          />\r\n        );\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const { open, openEditUser } = this.state;\r\n    return (\r\n      <Template>\r\n        <Head>\r\n          <link\r\n            rel=\"stylesheet\"\r\n            type=\"text/css\"\r\n            href=\"../static/css/profile.css\"\r\n          />\r\n        </Head>\r\n        <TopMenu props={this.props} />\r\n\r\n        <Modal open={open} onClose={this.onCloseModal}>\r\n          <div style={{ padding: \"45px\" }}>\r\n            <h2 style={{ textAlign: \"center\", marginBottom: \"25px\" }}>\r\n              Você escolheu esta imagem\r\n            </h2>\r\n            <img\r\n              className=\"img-fluid\"\r\n              style={{ width: \"30%\", display: \"block\", margin: \"0 auto\" }}\r\n              id=\"photoForUpload\"\r\n              src={this.state.file}\r\n              onChange={e => this.setState({ image: e })}\r\n            />\r\n            <p>{this.state.progress}</p>\r\n            <div\r\n              style={{\r\n                flexDirection: \"row\",\r\n                justifyContent: \"space-around\",\r\n                marginTop: \"45px\"\r\n              }}\r\n            >\r\n              <button\r\n                onClick={() => this._userEditFoto()}\r\n                style={{ float: \"right\" }}\r\n                className=\"btn btn-success\"\r\n              >\r\n                Finalizar\r\n              </button>\r\n\r\n              <button\r\n                onClick={() => this.onCloseModal()}\r\n                className=\"btn btn-danger\"\r\n                style={{ float: \"right\", marginRight: \"15px\" }}\r\n              >\r\n                Cancelar\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </Modal>\r\n\r\n        <Modal open={openEditUser} onClose={this.onCloseModalEditUser}>\r\n          <div style={{ padding: \"45px\" }}>\r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"nome\">Nome</label>\r\n              <input\r\n                className=\"form-control\"\r\n                value={this.state.nome}\r\n                onChange={e => this.setState({ nome: e.target.value })}\r\n                type=\"text\"\r\n                id=\"nome\"\r\n              />\r\n            </div>\r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"sexo\">Sexo</label>\r\n              <input\r\n                placeholder=\"Ex: Masculino\"\r\n                className=\"form-control\"\r\n                value={this.state.sexo}\r\n                onChange={e => this.setState({ sexo: e.target.value })}\r\n                type=\"text\"\r\n                id=\"sexo\"\r\n              />\r\n            </div>\r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"cpf\">CPF</label>\r\n              <input\r\n                placeholder=\"Digite apenas números\"\r\n                className=\"form-control\"\r\n                value={this.state.cpf}\r\n                onChange={e => this.setState({ cpf: e.target.value })}\r\n                type=\"text\"\r\n                id=\"cpf\"\r\n              />\r\n            </div>\r\n\r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"date\">Data de Nascimento</label>\r\n              <DatePicker\r\n                selected={this.state.data_de_nascimento}\r\n                onChange={d => this.handleChange(d)}\r\n                className=\"form-control\"\r\n                dateFormat=\"dd/MM/yyyy\"\r\n              />\r\n            </div>\r\n\r\n            <button\r\n              onClick={() => this._userEdit()}\r\n              className=\"btn btn-success\"\r\n            >\r\n              Finalizar\r\n            </button>\r\n          </div>\r\n        </Modal>\r\n\r\n        <ul className=\"nav nav-tabs\">\r\n          <li className=\"nav-item\">\r\n            <a\r\n              style={{ cursor: \"pointer\" }}\r\n              className=\"nav-link active\"\r\n              onClick={() => {\r\n                this.setState({\r\n                  tab: \"profile\"\r\n                });\r\n              }}\r\n            >\r\n              Profile\r\n            </a>\r\n          </li>\r\n          <li className=\"nav-item\">\r\n            <a\r\n              style={{ cursor: \"pointer\" }}\r\n              className=\"nav-link\"\r\n              onClick={() => {\r\n                this.setState({\r\n                  tab: \"address\"\r\n                });\r\n              }}\r\n            >\r\n              Adress\r\n            </a>\r\n          </li>\r\n\r\n          <li className=\"nav-item\">\r\n            <a\r\n              style={{ cursor: \"pointer\" }}\r\n              className=\"nav-link\"\r\n              onClick={() => {\r\n                this.setState({\r\n                  tab: \"cards\"\r\n                });\r\n              }}\r\n            >\r\n              Cartões\r\n            </a>\r\n          </li>\r\n\r\n          <li className=\"nav-item\">\r\n            <a\r\n              className=\"nav-link disabled\"\r\n              style={{ cursor: \"pointer\" }}\r\n              href=\"#\"\r\n            >\r\n              Social\r\n            </a>\r\n          </li>\r\n          <li className=\"nav-item\">\r\n            <a\r\n              className=\"nav-link disabled\"\r\n              style={{ cursor: \"pointer\" }}\r\n              href=\"#\"\r\n            >\r\n              History\r\n            </a>\r\n          </li>\r\n        </ul>\r\n\r\n        <div className=\"container-fluid\">{this.changeTab()}</div>\r\n\r\n        <div className=\"mt-0 pb-2\" />\r\n        <div id=\"clear\" />\r\n        <BottomMenu />\r\n      </Template>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n  return {};\r\n};\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    produto: state.MainReducer.produto\r\n  };\r\n};\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(profile);\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;AACA;AACA;AACA;AAAA;;;;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AADA;AAGA;;AACA;AACA;;AADA;;AACA;AACA;;AADA;AACA;AACA;AACA;AAAA;AAAA;AACA;;AACA;AACA;;;;;;;;;;;;;;;;;AAEA;AAAA;AACA;AADA;AACA;AAAA;AACA;AAFA;AAwFA;AAAA;AAAA;AACA;AACA;AA1FA;AA4FA;AAAA;AAAA;AACA;AACA;AA9FA;AAgGA;AAAA;AAAA;AACA;AACA;AAlGA;AAoGA;AAAA;AAAA;AACA;AACA;AAnGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAhBA;AACA;AAkBA;AACA;AAvBA;AAuBA;AACA;;;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AARA;AAUA;AACA;;;AAEA;AAAA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AADA;AAGA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AATA;AAWA;AACA;;;AAEA;AACA;AACA;AAEA;AACA;AACA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;AACA;AAEA;AACA;AACA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;AACA;;;AAkBA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AADA;AAGA;AACA;;;AAEA;AACA;AACA;AACA;AACA;AACA;AAJA;AAOA;AACA;;;AAEA;AACA;AACA;AACA;;;AAEA;AACA;AACA;AADA;AAGA;;;AAEA;AAAA;AACA;AAAA;AACA;AACA;AAEA;AACA;A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","sourceRoot":""}