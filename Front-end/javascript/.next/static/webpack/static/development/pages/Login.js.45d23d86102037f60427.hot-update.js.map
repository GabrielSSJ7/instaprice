{"version":3,"file":"static/webpack/static\\development\\pages\\Login.js.45d23d86102037f60427.hot-update.js","sources":["webpack:///./pages/index.js"],"sourcesContent":["import React from \"react\";\r\nimport { bindActionCreators } from \"redux\";\r\nimport io from \"socket.io-client\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport { validateToken } from \"../components/Util\";\r\nimport RenderProd from \"../components/RenderProd\";\r\nimport Template from \"../components/Template\";\r\nimport TopMenu from \"../components/TopMenu\";\r\nimport BottomMenu from \"../components/BottomMenu\";\r\n\r\nimport { startClock, addCount, serverRenderClock } from \"../config/store\";\r\nimport { getMainData } from \"../config/actions/MainAction\";\r\n\r\nconst socketUrl = \"http://localhost:4000\";\r\n\r\nlet socket = null;\r\n\r\nclass Index extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n   \r\n  }\r\n\r\n  static getInitialProps({ store, isServer, req }) {\r\n    const cookie = req ? req.headers.cookie : \"\";\r\n\r\n    if (cookie) {\r\n      const index = cookie.indexOf(\"bearer\");\r\n      let AuthToken = cookie.substr(index);\r\n\r\n      AuthToken = AuthToken.split(\"%20\").join(\" \");\r\n\r\n      try {\r\n        store.dispatch(getMainData(AuthToken));\r\n\r\n        return {};\r\n      } catch (e) {\r\n        return { produto: [] };\r\n      }\r\n    }\r\n\r\n    return {};\r\n  }\r\n  componentWillUnmount(){\r\n    socket.emit('desconectar', { reason: 'porque eu quis'})\r\n  }\r\n\r\n  componentDidMount() {\r\n    socket = io(socketUrl);\r\n    socket.on(\"connect\", function() {\r\n      //console.log(\"connected on Socket.Io\", socket.id);\r\n    });\r\n    validateToken(localStorage.getItem(\"authToken\"));\r\n\r\n    socket.on(\"usuarioSaiu\", function(data) {\r\n      //socket.emit(\"usuarioSaiu\",{ token: localStorage.getItem(\"authToken\")})\r\n      console.log(\"usuario saiu\", data);\r\n    });\r\n\r\n    if (this.props.produto.length === 0) {\r\n      this.props.getMainData(`bearer ${localStorage.getItem(\"authToken\")}`);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Template>\r\n        <TopMenu props={this.props} />\r\n\r\n        <RenderProd produto={this.props.produto} />\r\n\r\n        <BottomMenu />\r\n      </Template>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n  return {\r\n    getMainData: bindActionCreators(getMainData, dispatch)\r\n  };\r\n};\r\n\r\nconst mapStateToProps = state => {\r\n  //console.log(\"state.main\", state)\r\n  return {\r\n    produto: state.MainReducer.produto\r\n  };\r\n};\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(Index);\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AAEA;AACA;AACA;;;;;AACA;AAAA;AACA;AADA;AAGA;AACA;;;AAqBA;AACA;AAAA;AAAA;AACA;;;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;;;AAnDA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;;;;AAzBA;AACA;AA2DA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;A","sourceRoot":""}